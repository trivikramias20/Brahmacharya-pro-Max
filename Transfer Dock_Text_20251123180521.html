<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Karan The New Age Brahmachari PRO - Mastery Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">
<style>
/* --- PREMIUM LOOKS (DESIGN REFINEMENTS) --- */
:root{
    /* Deep Blue/Black Background */
    --bg: #0A0A1A; 
    --txt: #fff;
    /* Sophisticated Teal Accent */
    --accent: #10B981;
    --accent-light: #34D399;
    /* Subtle Glassmorphism Card BG */
    --card: rgba(16, 185, 129, .08);
    /* Soft Border */
    --border: rgba(52, 211, 153, .2);
    /* Quote Color */
    --quote: #FBBF24;
}

.light{
    --bg:#f5f5f5;--txt:#1a1a1a;--card:rgba(16, 185, 129, .05);--border:rgba(16, 185, 129, .2);
}

*{margin:0;padding:0;box-sizing:border-box;transition:background .3s,color .3s, transform .3s}
body{
    font-family:'Inter', -apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;
    background:var(--bg);
    color:var(--txt);
    min-height:100vh;
    overflow-x:hidden
}
.cosmic{position:fixed;width:100%;height:100%;z-index:0}
.star{position:absolute;background:var(--txt);border-radius:50%;animation:tw 3s infinite;opacity:.3}
@keyframes tw{0%,100%{opacity:.3}50%{opacity:1}}
.grad{position:fixed;top:0;left:0;width:100%;height:100%;background:radial-gradient(ellipse at top,rgba(16, 185, 129,.1),transparent 50%);pointer-events:none;z-index:1}
.container{position:relative;z-index:2;max-width:1400px;margin:0 auto;padding:20px}
header{text-align:center;padding:40px 20px 60px;position:relative}
.theme-btn{position:absolute;top:10px;right:20px;background:var(--card);border:1px solid var(--border);border-radius:50px;padding:8px 16px;cursor:pointer;font-size:1.2em;color:var(--txt)}
.logo{width:80px;height:80px;margin:0 auto 20px;background:linear-gradient(135deg,var(--accent-light),var(--accent));border-radius:20px;display:flex;align-items:center;justify-content:center;font-size:2.5em;box-shadow:0 10px 40px rgba(16, 185, 129,.4)}
h1{
    font-size:2.5em;
    font-weight:900;
    /* Teal/Green Gradient */
    background:linear-gradient(135deg,var(--accent-light),var(--accent));
    -webkit-background-clip:text;
    -webkit-text-fill-color:transparent;
    letter-spacing:-1px;
    margin-bottom:10px
}
.subtitle{font-size:1em;color:#9ca3af;font-weight:500}
.quote{text-align:center;font-style:italic;color:var(--quote);padding:15px;margin:20px 0;background:rgba(251,191,36,.1);border-radius:12px;font-size:.9em}

/* Card Styling */
.tracker{
    background:var(--card);
    backdrop-filter:blur(30px); /* Increased blur for premium feel */
    border:1px solid var(--border);
    border-radius:32px; /* Softer, larger radius */
    padding:40px 30px;
    margin-bottom:30px;
    box-shadow:0 20px 80px rgba(0,0,0,.4); /* Deeper shadow */
}

.title{
    text-align:center;font-size:1.6em;margin-bottom:30px;font-weight:800;
    background:linear-gradient(135deg,var(--accent-light),var(--accent));
    -webkit-background-clip:text;-webkit-text-fill-color:transparent
}
.streak{text-align:center;font-size:2.2em;margin-bottom:20px;font-weight:900}
.controls{text-align:center;margin-bottom:30px;display:flex;gap:10px;justify-content:center;flex-wrap:wrap}
.input{padding:14px 20px;border-radius:12px;background:rgba(255,255,255,.1);color:var(--txt);border:1px solid var(--border);font-size:.95em}
.btn{
    background:linear-gradient(135deg,var(--accent-light),var(--accent));
    color:#fff;
    padding:14px 30px;
    border:none;
    border-radius:12px;
    cursor:pointer;
    font-size:.95em;
    font-weight:700;
    box-shadow:0 4px 15px rgba(16, 185, 129,.3);
}
.btn:hover{transform:translateY(-3px);box-shadow:0 6px 20px rgba(16, 185, 129,.4)}
.btn-red{background:rgba(239,68,68,.2);border:1px solid rgba(239,68,68,.5);box-shadow:none;font-weight:500}
.btn-sm{padding:10px 18px;font-size:.9em}

/* New Grid Structure */
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:20px}
.unit{background:rgba(255,255,255,.05);border:1px solid var(--border);border-radius:20px;padding:30px 15px;text-align:center;transition:background .3s}
.unit:hover{background:rgba(255,255,255,.08);}

.val{
    font-size:2.8em; /* Larger, more impactful value */
    font-weight:900;
    background:linear-gradient(135deg,var(--accent-light),var(--accent));
    -webkit-background-clip:text;
    -webkit-text-fill-color:transparent
}
.val-mastery{
    /* Distinct color for Mastery Score */
    background:linear-gradient(135deg,#60a5fa,#2563eb);
    -webkit-background-clip:text;
    -webkit-text-fill-color:transparent;
    font-size:2.8em;font-weight:900;
}
.label{font-size:.85em;color:#9ca3af;margin-top:8px;text-transform:uppercase;font-weight:600}

.prog{margin-top:40px;padding:30px;background:rgba(255,255,255,.05);border-radius:20px;border:1px solid var(--border)}
.bar{height:10px;background:rgba(52, 211, 153,.2);border-radius:10px;overflow:hidden;margin:15px 0}
.fill{height:100%;background:linear-gradient(90deg,var(--accent),var(--accent-light));border-radius:10px;transition:width .5s}

.badges{display:flex;gap:12px;justify-content:center;margin-top:20px;flex-wrap:wrap}
.badge{background:rgba(16, 185, 129,.2);border:1px solid rgba(16, 185, 129,.4);padding:10px 18px;border-radius:25px;font-size:.9em;opacity:.5;font-weight:500;transition:all .3s}
.badge.earned{opacity:1;box-shadow:0 0 15px rgba(16, 185, 129,.6);background:var(--accent);color:#0A0A1A;font-weight:700}

.chart-box{margin-top:40px;padding:30px;background:rgba(255,255,255,.05);border-radius:20px;border:1px solid var(--border)}
.chart-title{text-align:center;font-weight:700;color:var(--accent-light);margin-bottom:20px;font-size:1.3em}

/* Card grid for Features */
.cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:20px;margin-top:30px}
.card{
    background:var(--card);
    backdrop-filter:blur(30px);
    border:1px solid var(--border);
    border-radius:24px;
    padding:30px;
    cursor:pointer;
    transition:all .3s;
    box-shadow:0 10px 20px rgba(0,0,0,.2);
}
.card:hover{transform:translateY(-10px);border-color:var(--accent);box-shadow:0 20px 40px rgba(16, 185, 129,.3)}
.icon{font-size:2.8em;margin-bottom:15px;color:var(--accent-light)}
.ctitle{font-size:1.5em;margin-bottom:10px;font-weight:800;color:var(--accent-light)}
.card p{color:#9ca3af;font-size:.95em}

.qsec{margin-top:40px;padding:30px;background:var(--card);backdrop-filter:blur(30px);border:1px solid var(--border);border-radius:24px;text-align:center}
.qtxt{font-size:1.4em;font-style:italic;color:#d1d5db;margin-bottom:15px;line-height:1.6}
.qauth{font-size:1.1em;color:var(--accent-light);font-weight:700}
.qref{cursor:pointer;display:inline-block;margin-top:15px;padding:10px 25px;background:rgba(16, 185, 129,.2);border:1px solid var(--border);border-radius:25px;font-size:.9em;font-weight:600}
.qref:hover{background:rgba(16, 185, 129,.3)}

/* Modal Styles Refined */
.modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.98);z-index:9999;overflow-y:auto}
.mcontent{background:linear-gradient(135deg,rgba(10,10,30,.98),rgba(20,20,50,.98));border:1px solid var(--border);border-radius:30px;max-width:900px;margin:30px auto;padding:40px 30px;position:relative}
.close{position:absolute;top:25px;right:25px;font-size:1.6em;cursor:pointer;color:#9ca3af;background:rgba(255,255,255,.1);border:1px solid rgba(255,255,255,.2);border-radius:50%;width:40px;height:40px;display:flex;align-items:center;justify-content:center}
.close:hover{background:rgba(239,68,68,.3);color:#ef4444}
.mtitle{font-size:2.2em;margin-bottom:25px;font-weight:900;background:linear-gradient(135deg,var(--accent-light),var(--accent));-webkit-background-clip:text;-webkit-text-fill-color:transparent;padding-right:60px}
.section{margin-bottom:20px;padding:25px;background:rgba(16, 185, 129,.05);border-radius:16px;border-left:4px solid var(--accent)}
.section h3{margin-bottom:10px;color:var(--accent-light);font-weight:800;font-size:1.2em}
.section p{color:#d1d5db;line-height:1.6;font-size:1em}
.shloka{font-style:italic;color:var(--quote);background:rgba(251,191,36,.1);padding:25px;border-radius:16px;margin:20px 0;border-left:4px solid var(--quote);line-height:1.8}
.tasks{list-style:none;margin-top:20px}
.task{background:rgba(16, 185, 129,.1);padding:15px 20px;margin:10px 0;border-radius:12px;border-left:3px solid var(--accent);color:#d1d5db;font-weight:500}
.textarea{width:100%;min-height:300px;background:rgba(255,255,255,.1);border:1px solid var(--border);border-radius:16px;padding:20px;color:var(--txt);font-size:1em;font-family:inherit;line-height:1.6;resize:vertical;font-weight:400}

/* Habits Grid Refined */
.habit-grid{display:grid;gap:15px;margin-top:15px}
.habit{display:flex;align-items:center;gap:15px;background:rgba(16, 185, 129,.1);padding:15px 20px;border-radius:12px;border-left:4px solid var(--accent);cursor:pointer;transition:all .3s}
.habit:hover{background:rgba(16, 185, 129,.15)}
.habit input{width:20px;height:20px;cursor:pointer;accent-color:var(--accent)}
.habit.done{opacity:.6;text-decoration:line-through;border-left-color:gray;}

.timer-opts{display:flex;gap:15px;justify-content:center;margin:20px 0;flex-wrap:wrap}
.timer-display{
    font-size:5em;font-weight:900;text-align:center;margin:30px 0;
    background:linear-gradient(135deg,var(--accent-light),var(--accent));
    -webkit-background-clip:text;-webkit-text-fill-color:transparent
}

/* Responsive */
@media(max-width:768px){h1{font-size:1.8em}.grid{grid-template-columns:repeat(2,1fr)}.val,.val-mastery{font-size:2em}}
</style>
</head>
<body>
<div class="cosmic" id="cosmic"></div>
<div class="grad"></div>
<div class="container">
<header>
<div class="theme-btn" onclick="toggleTheme()">üåì</div>
<div class="logo">üî±</div>
<h1>KARAN THE NEW AGE BRAHMACHARI</h1>
<p class="subtitle">Journey of Self-Mastery & Ancient Wisdom</p>
<div class="quote" id="quote">"‡§¨‡•ç‡§∞‡§π‡•ç‡§Æ‡§ö‡§∞‡•ç‡§Ø‡•á‡§£ ‡§§‡§™‡§∏‡§æ ‡§¶‡•á‡§µ‡§æ ‡§Æ‡•É‡§§‡•ç‡§Ø‡•Å‡§Æ‡§™‡§æ‡§ò‡•ç‡§®‡§§"</div>
</header>

<div class="tracker">
    <h2 class="title">üî± Digital Tracker & Mastery Score</h2>
    <div class="streak" id="streak">üî• 0 Day Streak</div>
    
    <div class="controls">
        <input type="datetime-local" id="dt" class="input">
        <button class="btn" onclick="startTimer()">üöÄ Start Journey</button>
        <button class="btn btn-red" onclick="resetTimer()">‚ùå Reset</button>
    </div>

    <div class="grid">
        <div class="unit"><div class="val" id="d">0</div><div class="label">Days</div></div>
        <div class="unit"><div class="val" id="h">0</div><div class="label">Hours</div></div>
        <div class="unit"><div class="val-mastery" id="masteryScore">0%</div><div class="label">Mastery Score</div></div>
        <div class="unit"><div class="val" id="m">0</div><div class="label">Minutes</div></div>
    </div>

    <div class="prog">
        <div style="display:flex;justify-content:space-between;margin-bottom:10px">
            <span style="font-weight:600">Next Milestone</span>
            <span id="mt" style="color:var(--accent-light);font-weight:700">7 Days</span>
        </div>
        <div class="bar"><div class="fill" id="pf" style="width:0%"></div></div>
        <div id="tx" style="text-align:center;color:#9ca3af;font-size:.9em;margin-top:10px">Keep going! üî•</div>
        <div class="badges">
            <div class="badge" id="b7">üèÖ 7 Days</div>
            <div class="badge" id="b30">üèÜ 30 Days</div>
            <div class="badge" id="b90">üíé 90 Days</div>
            <div class="badge" id="b365">üëë 365 Days</div>
        </div>
    </div>
    
    <div class="chart-box">
        <div class="chart-title">üìà Last 30 Days Mastery Trend</div>
        <canvas id="chart"></canvas>
    </div>
</div>

<div class="cards">
    <div class="card" onclick="openModal('m1')"><div class="icon">üî•</div><div class="ctitle">Urge Emergency Protocol</div><p>Immediate, structured response to urges.</p></div>
    <div class="card" onclick="openModal('m2')"><div class="icon">‚ú®</div><div class="ctitle">Ojas & Vitality Benefits</div><p>Ayurvedic wisdom on Shukra Dhatu retention.</p></div>
    <div class="card" onclick="openModal('m3')"><div class="icon">‚ö†Ô∏è</div><div class="ctitle">Kshaya Disadvantages</div><p>Effects of vital energy depletion (Shukra Dhatu Kshaya).</p></div>
    <div class="card" onclick="openModal('m4')"><div class="icon">üåø</div><div class="ctitle">Ayurvedic Wisdom</div><p>Deep insight into Dhatu Saptak & Urdhvaretas.</p></div>
    <div class="card" onclick="openModal('m5')"><div class="icon">üìú</div><div class="ctitle">My Mastery Rules</div><p>Personal guidelines and self-promises.</p></div>
    <div class="card" onclick="openModal('m6')"><div class="icon">‚úÖ</div><div class="ctitle">Daily Habits Tracker</div><p>Track your practices for the Mastery Score.</p></div>
    <div class="card" onclick="openModal('m7')"><div class="icon">üìù</div><div class="ctitle">Reflection Journal</div><p>Daily notes, mood, and insights.</p></div>
    <div class="card" onclick="openModal('m8')"><div class="icon">üßò</div><div class="ctitle">Focus Timer</div><p>Guided & unguided meditation sessions.</p></div>
</div>

<div class="qsec">
    <div class="qtxt" id="engQuote">"You have to dream before your dreams can come true."</div>
    <div class="qauth" id="engAuthor">- Dr. APJ Abdul Kalam</div>
    <div class="qref" onclick="newQuote()">üîÑ New Wisdom (AI Suggestion)</div>
</div>
</div>

<div id="m1" class="modal" onclick="if(event.target==this)closeModal('m1')">
<div class="mcontent">
<div class="close" onclick="closeModal('m1')">√ó</div>
<h2 class="mtitle">üî• Urge Emergency Protocol</h2>
<ul class="tasks">
<li class="task">üßò Do 20 minutes of meditation or pranayama</li>
<li class="task">üèÉ Perform 50 push-ups or 100 jumping jacks</li>
<li class="task">üöø Take a cold shower right now</li>
<li class="task">üìñ Read sacred texts for 15 minutes</li>
<li class="task">üö∂ Go for a 30-minute walk outside</li>
<li class="task">‚òéÔ∏è Call a mentor or trusted friend</li>
<li class="task">‚úçÔ∏è Write down your goals</li>
<li class="task">üéµ Listen to spiritual music</li>
<li class="task">üôè Chant "Om Namah Shivaya" 108 times</li>
<li class="task">üí™ This urge is temporary, your goals are permanent</li>
</ul>
</div>
</div>
<div id="m2" class="modal" onclick="if(event.target==this)closeModal('m2')">
<div class="mcontent">
<div class="close" onclick="closeModal('m2')">√ó</div>
<h2 class="mtitle">‚ú® Benefits of Shukra Dhatu Retention</h2>
<div class="shloka">"‡§Æ‡§π‡§æ‡§µ‡•Ä‡§∞‡•ç‡§Ø‡§µ‡§æ‡§®‡•ç ‡§≠‡§µ‡§§‡§ø ‡§¨‡§≤‡§µ‡§æ‡§®‡•ç ‡§™‡§£‡•ç‡§°‡§ø‡§§‡•ã ‡§¶‡•Ä‡§∞‡•ç‡§ò‡§æ‡§Ø‡•Å‡§∞‡•ç‡§≠‡§µ‡§§‡§ø‡•§"<br>(Mahabali, intelligent, and long-lived becomes one who preserves vital energy)</div>
<div class="section"><h3>üß† Mental Benefits</h3><p>Enhanced memory, concentration, and intellectual capacity. Clarity of thought and improved decision-making abilities.</p></div>
<div class="section"><h3>üí™ Physical Benefits</h3><p>Increased strength, vitality, and endurance. Improved immunity and overall health. Radiant skin and energetic presence.</p></div>
<div class="section"><h3>üî• Spiritual Benefits</h3><p>Enhanced spiritual practices, deeper meditation, awakening of Kundalini energy, and connection with higher consciousness.</p></div>
<div class="section"><h3>üòä Emotional Benefits</h3><p>Increased confidence, emotional stability, inner peace, and magnetism. Improved relationships and social interactions.</p></div>
</div>
</div>
<div id="m3" class="modal" onclick="if(event.target==this)closeModal('m3')">
<div class="mcontent">
<div class="close" onclick="closeModal('m3')">√ó</div>
<h2 class="mtitle">‚ö†Ô∏è Disadvantages of Shukra Dhatu Kshaya</h2>
<div class="shloka">"‡§∂‡•Å‡§ï‡•ç‡§∞‡§ï‡•ç‡§∑‡§Ø‡•á ‡§¶‡•å‡§∞‡•ç‡§¨‡§≤‡•ç‡§Ø‡§Ç ‡§Æ‡§®‡•ç‡§¶‡§æ‡§ó‡•ç‡§®‡§ø‡§∂‡•ç‡§ö ‡§™‡•ç‡§∞‡§ú‡§æ‡§Ø‡§§‡•á‡•§"<br>(Loss of Shukra leads to weakness and diminished digestive fire)</div>
<div class="section"><h3>üîª Physical Deterioration</h3><p>Weakness, fatigue, loss of vitality. Diminished immunity, frequent illness. Premature aging and loss of luster.</p></div>
<div class="section"><h3>üß† Mental Decline</h3><p>Poor memory and concentration. Anxiety, depression, and mood swings. Lack of motivation and mental fog.</p></div>
<div class="section"><h3>üíî Emotional Instability</h3><p>Loss of confidence and self-esteem. Irritability and social withdrawal. Lack of purpose and direction.</p></div>
<div class="section"><h3>üö´ Spiritual Blockage</h3><p>Difficulty in meditation and spiritual practices. Disconnection from higher self. Obstacles in spiritual progress.</p></div>
</div>
</div>
<div id="m4" class="modal" onclick="if(event.target==this)closeModal('m4')">
<div class="mcontent">
<div class="close" onclick="closeModal('m4')">√ó</div>
<h2 class="mtitle">üåø Ayurveda on Semen (Shukra Dhatu)</h2>
<div class="shloka">"‡§∞‡§∏‡§æ‡§¶‡•ç ‡§∞‡§ï‡•ç‡§§‡§Ç ‡§§‡§§‡•ã ‡§Æ‡§æ‡§Ç‡§∏‡§Ç ‡§Æ‡§æ‡§Ç‡§∏‡§æ‡§®‡•ç‡§Æ‡•á‡§¶‡§É ‡§™‡•ç‡§∞‡§ú‡§æ‡§Ø‡§§‡•á‡•§<br>‡§Æ‡•á‡§¶‡§∏‡•ã‡§Ω‡§∏‡•ç‡§•‡§ø ‡§§‡§§‡•ã ‡§Æ‡§ú‡•ç‡§ú‡§æ ‡§Æ‡§ú‡•ç‡§ú‡§æ‡§Ø‡§æ‡§É ‡§∂‡•Å‡§ï‡•ç‡§∞‡§∏‡§Æ‡•ç‡§≠‡§µ‡§É‡•§‡•§"<br>(From plasma to blood to muscle to fat to bone to marrow - finally Shukra is formed)</div>
<div class="section"><h3>üìö The Seventh Dhatu</h3><p>Shukra Dhatu is the seventh and most refined tissue element. It takes 40 days to produce one drop. It is the essence of all bodily tissues.</p></div>
<div class="section"><h3>üî¨ Transformation</h3><p>When conserved through Brahmacharya, it transforms into Ojas - the supreme essence that gives radiance and immunity.</p></div>
<div class="section"><h3>‚ö° Urdhvaretas</h3><p>Sexual energy rises upward through Sushumna Nadi, awakening chakras and transforming into spiritual power.</p></div>
<div class="section"><h3>üåü Ojas</h3><p>Preserved Shukra converts to Ojas - manifesting as golden aura, magnetic personality, exceptional health, and spiritual radiance.</p></div>
</div>
</div>
<div id="m5" class="modal" onclick="if(event.target==this)closeModal('m5')">
<div class="mcontent">
<div class="close" onclick="closeModal('m5')">√ó</div>
<h2 class="mtitle">üìú My Personal Rules</h2>
<textarea id="rules" class="textarea" placeholder="Enter your rules here..."></textarea>
<button class="btn" onclick="saveRules()">üíæ Save Rules</button>
</div>
</div>
<div id="m6" class="modal" onclick="if(event.target==this)closeModal('m6')">
<div class="mcontent">
<div class="close" onclick="closeModal('m6')">√ó</div>
<h2 class="mtitle">‚úÖ Daily Habits Tracker</h2>
<div class="habit-grid" id="habits"></div>
<button class="btn" style="margin-top:20px" onclick="addHabit()">‚ûï Add Custom Habit</button>
</div>
</div>
<div id="m7" class="modal" onclick="if(event.target==this)closeModal('m7')">
<div class="mcontent">
<div class="close" onclick="closeModal('m7')">√ó</div>
<h2 class="mtitle">üìù Brahmacharya Journal</h2>
<textarea id="journal" class="textarea" placeholder="Write your thoughts..."></textarea>
<button class="btn" onclick="saveJournal()">üíæ Save Entry</button>
</div>
</div>
<div id="m8" class="modal" onclick="if(event.target==this)closeModal('m8')">
<div class="mcontent">
<div class="close" onclick="closeModal('m8')">√ó</div>
<h2 class="mtitle">üßò Meditation & Focus Timer</h2>
<div class="timer-opts">
<button class="btn btn-sm" onclick="setTimer(5)">5 min</button>
<button class="btn btn-sm" onclick="setTimer(10)">10 min</button>
<button class="btn btn-sm" onclick="setTimer(15)">15 min</button>
<button class="btn btn-sm" onclick="setTimer(20)">20 min</button>
<button class="btn btn-sm" onclick="setTimer(30)">30 min</button>
</div>
<div class="timer-display" id="tdisp">00:00</div>
<div style="text-align:center">
<button class="btn" id="tctrl" onclick="toggleTimer()">‚ñ∂Ô∏è Start</button>
</div>
</div>
</div>

<script>
// --- JAVASCRIPT LOGIC (ENRICHMENT) ---
let st=null,ms=[7,30,90,365],medT=null,medS=0,medTot=0,q=[
{t:"The greatest glory in living lies not in never falling, but in rising every time we fall.",a:"Nelson Mandela"},
{t:"Excellence is a continuous process and not an accident.",a:"Dr. APJ Abdul Kalam"},
{t:"Man needs difficulties because they are necessary to enjoy success.",a:"Dr. APJ Abdul Kalam"},
{t:"If you want to shine like a sun, first burn like a sun.",a:"Dr. APJ Abdul Kalam"},
{t:"Failure will never overtake me if my determination is strong enough.",a:"Dr. APJ Abdul Kalam"},
{t:"Success is not final, failure is not fatal: courage to continue counts.",a:"Winston Churchill"},
{t:"It does not matter how slowly you go as long as you do not stop.",a:"Confucius"},
{t:"Hard work beats talent when talent doesn't work hard.",a:"Tim Notke"},
{t:"The only way to do great work is to love what you do.",a:"Steve Jobs"},
{t:"Self-control is strength. Right thought is mastery. Calmness is power.",a:"James Allen"},
{t:"Discipline is the bridge between goals and accomplishment.",a:"Jim Rohn"},
{t:"The first and greatest victory is to conquer yourself.",a:"Plato"},
{t:"With self-discipline most anything is possible.",a:"Theodore Roosevelt"},
{t:"Education is the most powerful weapon to change the world.",a:"Nelson Mandela"},
{t:"The expert in anything was once a beginner.",a:"Helen Hayes"},
{t:"Genius is one percent inspiration and ninety-nine percent perspiration.",a:"Thomas Edison"},
{t:"Strength comes from an indomitable will.",a:"Mahatma Gandhi"},
{t:"Be the change you wish to see in the world.",a:"Mahatma Gandhi"},
{t:"In a gentle way, you can shake the world.",a:"Mahatma Gandhi"},
{t:"Believe you can and you're halfway there.",a:"Theodore Roosevelt"}
],hbs=["üßò Morning Meditation","üèÉ Exercise / Yoga","üìñ Read Sacred Texts","ü•ó Sattvic Diet","‚è∞ Wake Before Sunrise","üöø Cold Shower","üôè Evening Prayer","üìù Daily Reflection"];

// Star animation logic (unchanged)
for(let i=0;i<200;i++){let s=document.createElement('div');s.className='star';s.style.width=s.style.height=Math.random()*3+'px';s.style.left=Math.random()*100+'%';s.style.top=Math.random()*100+'%';document.getElementById('cosmic').appendChild(s)}

function toggleTheme(){document.body.classList.toggle('light')}
function newQuote(){let r=q[Math.floor(Math.random()*q.length)];document.getElementById('engQuote').textContent='"'+r.t+'"';document.getElementById('engAuthor').textContent='- '+r.a}

// ENRICHMENT: Improved Chart Function to show Mastery Score Trend
function drawChart(){
    let c=document.getElementById('chart'),ctx=c.getContext('2d');
    c.width=c.parentElement.clientWidth-50;
    c.height=250;
    let w=c.width,h=c.height,days=30;
    
    // Simulate 30 days of Mastery Scores (0% to 100%) for visualization
    let masteryData = [];
    let todayScore = load('masteryScore') || 0;
    // Simple simulation: last 5 days are high, before that random
    for(let i=0;i<days-1;i++){
        if (i > days - 6) {
            masteryData.push(Math.min(100, 70 + Math.floor(Math.random() * 30)));
        } else {
            masteryData.push(Math.floor(Math.random() * 80));
        }
    }
    masteryData.push(todayScore); // Today's actual score

    let max=100;
    
    ctx.clearRect(0,0,w,h);
    
    // Grid Lines (Subtle)
    ctx.strokeStyle='rgba(52, 211, 153,.1)'; 
    ctx.lineWidth=1;
    for(let i=0;i<=4;i++){
        let y=h-10-(h-20)*i/4; // 0, 25, 50, 75, 100%
        ctx.beginPath();
        ctx.moveTo(30,y);
        ctx.lineTo(w-10,y);
        ctx.stroke();
    }
    
    // Line Graph (Accent Color)
    ctx.strokeStyle='var(--accent-light)';
    ctx.lineWidth=3;
    ctx.beginPath();
    for(let i=0;i<masteryData.length;i++){
        let x=30+(w-40)*i/(days-1);
        let y=h-10-(h-20)*masteryData[i]/max;
        if(i===0)ctx.moveTo(x,y);
        else ctx.lineTo(x,y);
    }
    ctx.stroke();
    
    // Data Points (Accent Color)
    ctx.fillStyle='var(--accent)';
    for(let i=0;i<masteryData.length;i++){
        let x=30+(w-40)*i/(days-1);
        let y=h-10-(h-20)*masteryData[i]/max;
        ctx.beginPath();
        ctx.arc(x,y,5,0,2*Math.PI);
        ctx.fill()
    }
}

function save(k,v){localStorage.setItem(k,JSON.stringify(v))}
function load(k){let v=localStorage.getItem(k);return v?JSON.parse(v):null}

function init(){
    let sv=load('bs');
    if(sv){
        st=new Date(sv);
        document.getElementById('dt').value=new Date(st.getTime()-st.getTimezoneOffset()*60000).toISOString().slice(0,16);
    }else{
        // Initial setup for new user
        st=new Date();
        document.getElementById('dt').value=new Date(st.getTime()-st.getTimezoneOffset()*60000).toISOString().slice(0,16);
    }
    upd();
    setInterval(upd,1000);
    setInterval(drawChart,5000);
    drawChart();
    loadHabits();
}

function upd(){
    if(!st)return;
    let n=new Date(),df=n-st;
    
    // Handle negative time difference (if start date is in the future)
    if(df<0){
        document.getElementById('d').textContent='0';
        document.getElementById('h').textContent='0';
        document.getElementById('m').textContent='0';
        document.getElementById('s').textContent='0';
        return
    }

    let dy=Math.floor(df/86400000),
        hr=Math.floor((df%86400000)/3600000),
        mn=Math.floor((df%3600000)/60000),
        sc=Math.floor((df%60000)/1000);
        
    document.getElementById('d').textContent=dy;
    document.getElementById('h').textContent=hr;
    // Seconds element removed from HTML, we will update minutes only
    document.getElementById('m').textContent=mn; 

    document.getElementById('streak').innerHTML=dy>0?`üî• ${dy} Day Streak`:`üî• 0 Day Streak`;
    
    // Milestone and Progress Logic
    let nm=ms.find(x=>x>dy)||365,
        pm=ms.filter(x=>x<=dy).pop()||0,
        pg=((dy-pm)/(nm-pm))*100;
        
    pg=Math.min(pg,100);
    document.getElementById('pf').style.width=pg+'%';
    document.getElementById('mt').textContent=nm+' Days';
    
    if(dy>=365)document.getElementById('tx').textContent='üèÜ Legendary!';
    else if(dy>=90)document.getElementById('tx').textContent='‚ö° Unstoppable!';
    else if(dy>=30)document.getElementById('tx').textContent='üî• Amazing!';
    else if(dy>=7)document.getElementById('tx').textContent='üí™ Great start!';
    else document.getElementById('tx').textContent='Keep going! üî•';
    
    // Badge Logic
    if(dy>=7)document.getElementById('b7').classList.add('earned');
    if(dy>=30)document.getElementById('b30').classList.add('earned');
    if(dy>=90)document.getElementById('b90').classList.add('earned');
    if(dy>=365)document.getElementById('b365').classList.add('earned');

    // ENRICHMENT: Update Mastery Score
    calculateMasteryScore();
}

function startTimer(){
    let v=document.getElementById('dt').value;
    if(!v){alert('‚ö†Ô∏è Select date and time!');return}
    st=new Date(v);
    save('bs',st.toISOString());
    alert('‚úÖ Journey started! üí™');
    upd();
    drawChart();
}

function resetTimer(){
    if(confirm('Resetting will erase your streak. Are you sure?')){
        st=new Date();
        document.getElementById('dt').value=new Date(st.getTime()-st.getTimezoneOffset()*60000).toISOString().slice(0,16);
        save('bs',st.toISOString());
        
        // Reset habits for the day upon reset
        let h = load('habits') || hbs.map(n=>({name:n,done:false}));
        h = h.map(hb => ({...hb, done: false}));
        save('habits', h);
        save('lastHabitCheck', new Date().toDateString());
        
        alert('üîÑ Reset successful! Starting a new journey.');
        upd();
        drawChart();
    }
}

// ENRICHMENT: Calculate and Display Mastery Score
function calculateMasteryScore(){
    let h = load('habits') || hbs.map(n=>({name:n,done:false}));
    const total = h.length;
    const completed = h.filter(hb => hb.done).length;
    let score = (total > 0) ? Math.round((completed / total) * 100) : 0;
    document.getElementById('masteryScore').textContent = score + '%';
    save('masteryScore', score); // Save today's score for chart simulation
}

function loadHabits(){
    let h = load('habits');
    let lastCheck = load('lastHabitCheck');
    const today = new Date().toDateString();

    if(!h || h.length === 0) {
        // Initialize with default habits
        h = hbs.map(n => ({name: n, done: false}));
    } else if (lastCheck !== today) {
        // Reset 'done' status for a new day if date has changed
        h = h.map(hb => ({name: hb.name, done: false}));
    }
    
    let c=document.getElementById('habits');
    c.innerHTML='';
    h.forEach((hb,i)=>{
        let d=document.createElement('div');
        d.className='habit'+(hb.done?' done':'');
        d.innerHTML=`<input type="checkbox" ${hb.done?'checked':''} onchange="toggleHabit(${i})"><span>${hb.name}</span>`;
        c.appendChild(d);
    });

    save('habits',h);
    save('lastHabitCheck', today);
    calculateMasteryScore();
}

function toggleHabit(i){
    let h=load('habits')||hbs.map(n=>({name:n,done:false}));
    h[i].done=!h[i].done;
    
    // Update the visual class immediately
    const habitElements = document.getElementById('habits').children;
    if (h[i].done) {
        habitElements[i].classList.add('done');
    } else {
        habitElements[i].classList.remove('done');
    }

    save('habits',h);
    calculateMasteryScore();
}

function addHabit(){
    let n=prompt('Enter habit name:');
    if(n){
        let h=load('habits')||[];
        h.push({name:n,done:false});
        loadHabits(); // Reloads and saves the new list
    }
}

function saveRules(){save('rules',document.getElementById('rules').value);alert('‚úÖ Rules saved!')}
function saveJournal(){save('journal',document.getElementById('journal').value);alert('‚úÖ Journal saved!')}

function setTimer(min){
    medTot=min*60;
    medS=medTot;
    updateTimer();
    if(medT){clearInterval(medT);medT=null;document.getElementById('tctrl').textContent='‚ñ∂Ô∏è Start'}
}

function updateTimer(){
    let m=Math.floor(medS/60),s=medS%60;
    document.getElementById('tdisp').textContent=(m<10?'0':'')+m+':'+(s<10?'0':'')+s
}

function toggleTimer(){
    if(medT){
        clearInterval(medT);
        medT=null;
        document.getElementById('tctrl').textContent='‚ñ∂Ô∏è Start'
    }else{
        if(medS===0){alert('‚ö†Ô∏è Select duration!');return}
        medT=setInterval(()=>{
            medS--;
            updateTimer();
            if(medS<=0){
                clearInterval(medT);
                medT=null;
                document.getElementById('tctrl').textContent='‚ñ∂Ô∏è Start';
                alert('üßò Session Complete! Well done.');
                medS=medTot; // Reset for next session
            }
        },1000);
        document.getElementById('tctrl').textContent='‚è∏Ô∏è Pause'
    }
}

function openModal(id){
    document.getElementById(id).style.display='block';
    document.body.style.overflow='hidden';
    
    if(id==='m5'){let r=load('rules');if(r)document.getElementById('rules').value=r}
    if(id==='m6')loadHabits();
    if(id==='m7'){let j=load('journal');if(j)document.getElementById('journal').value=j}
}

function closeModal(id){
    document.getElementById(id).style.display='none';
    document.body.style.overflow='auto';
}

init();newQuote();
</script>
</body>
</html>